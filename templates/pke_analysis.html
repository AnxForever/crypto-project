{% extends "base.html" %}

{% block title %}PKEæ€§èƒ½åˆ†æ - å¯†ç å­¦å·¥å…·å¹³å°{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title"><i class="fas fa-chart-line"></i> PKEæ€§èƒ½åˆ†æ</h1>
    <p class="page-description">
        æ·±å…¥åˆ†æECCã€ElGamalã€SM2ä¸‰ç§PKEç®—æ³•çš„æ€§èƒ½è¡¨ç°ï¼Œé€šè¿‡å¯è§†åŒ–å›¾è¡¨å±•ç¤ºå„ç®—æ³•åœ¨ä¸åŒç»´åº¦çš„å¯¹æ¯”ã€‚
    </p>
</div>

<!-- æ€§èƒ½æ¦‚è§ˆ -->
<div class="content-card">
    <h2 class="card-title"><i class="fas fa-tachometer-alt"></i> æ€§èƒ½æ¦‚è§ˆ</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-key"></i></div>
            <div class="stat-info">
                <div class="stat-value" id="totalSchemes">3</div>
                <div class="stat-label">PKEç®—æ³•</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-clock"></i></div>
            <div class="stat-info">
                <div class="stat-value" id="avgEncryptTime">-</div>
                <div class="stat-label">å¹³å‡åŠ å¯†æ—¶é—´</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-unlock"></i></div>
            <div class="stat-info">
                <div class="stat-value" id="avgDecryptTime">-</div>
                <div class="stat-label">å¹³å‡è§£å¯†æ—¶é—´</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-trophy"></i></div>
            <div class="stat-info">
                <div class="stat-value" id="bestPerformer">-</div>
                <div class="stat-label">æœ€ä¼˜ç®—æ³•</div>
            </div>
        </div>
    </div>
</div>

<!-- ä¸“é¡¹åˆ†æå›¾è¡¨å±•ç¤º -->
<div class="content-card">
    <h2 class="card-title"><i class="fas fa-chart-area"></i> PKEä¸“é¡¹æ€§èƒ½åˆ†æå›¾è¡¨</h2>
    <p class="card-description">åŸºäºçœŸå®ç®—æ³•åº“æµ‹è¯•æ•°æ®ç”Ÿæˆçš„é«˜è´¨é‡æ€§èƒ½åˆ†æå›¾è¡¨ï¼Œä¸“æ³¨PKEç®—æ³•å†…éƒ¨å¯¹æ¯”ã€‚</p>
    
    <div class="specialized-charts">
        <!-- æ€§èƒ½å…¨æ™¯å›¾ -->
        <div class="chart-section">
            <div class="chart-header">
                <h3><i class="fas fa-binoculars"></i> æ€§èƒ½å…¨æ™¯åˆ†æ</h3>
                <p>å…¨é¢å¯¹æ¯”å¯†é’¥ç”Ÿæˆã€åŠ å¯†ã€è§£å¯†æ€§èƒ½ï¼ŒåŒ…å«ç»¼åˆé›·è¾¾å›¾åˆ†æ</p>
            </div>
            <div class="chart-image-container">
                <img src="{{ url_for('static', filename='images/pke_only_performance_overview.png') }}" 
                     alt="PKEæ€§èƒ½å…¨æ™¯åˆ†æ" class="analysis-chart" 
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div class="chart-placeholder" style="display: none;">
                    <i class="fas fa-image"></i>
                    <p>å›¾è¡¨ç”Ÿæˆä¸­ï¼Œè¯·ç¨ååˆ·æ–°é¡µé¢</p>
                </div>
            </div>
        </div>
        
        <!-- æ•ˆç‡åˆ†æå›¾ -->
        <div class="chart-section">
            <div class="chart-header">
                <h3><i class="fas fa-tachometer-alt"></i> æ•ˆç‡æ·±åº¦åˆ†æ</h3>
                <p>å¯†æ–‡è†¨èƒ€ç‡ã€ååé‡å¯¹æ¯”åŠæ•ˆç‡çƒ­åŠ›å›¾åˆ†æ</p>
            </div>
            <div class="chart-image-container">
                <img src="{{ url_for('static', filename='images/pke_only_efficiency_analysis.png') }}" 
                     alt="PKEæ•ˆç‡åˆ†æ" class="analysis-chart"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div class="chart-placeholder" style="display: none;">
                    <i class="fas fa-image"></i>
                    <p>å›¾è¡¨ç”Ÿæˆä¸­ï¼Œè¯·ç¨ååˆ·æ–°é¡µé¢</p>
                </div>
            </div>
        </div>
        
        <!-- è§„æ¨¡é€‚åº”æ€§åˆ†æ -->
        <div class="chart-section">
            <div class="chart-header">
                <h3><i class="fas fa-expand-arrows-alt"></i> æ•°æ®è§„æ¨¡é€‚åº”æ€§</h3>
                <p>ä¸åŒæ•°æ®å¤§å°ä¸‹çš„æ€§èƒ½å˜åŒ–è¶‹åŠ¿åˆ†æ</p>
            </div>
            <div class="chart-image-container">
                <img src="{{ url_for('static', filename='images/pke_only_scalability_analysis.png') }}" 
                     alt="PKEè§„æ¨¡é€‚åº”æ€§åˆ†æ" class="analysis-chart"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div class="chart-placeholder" style="display: none;">
                    <i class="fas fa-image"></i>
                    <p>å›¾è¡¨ç”Ÿæˆä¸­ï¼Œè¯·ç¨ååˆ·æ–°é¡µé¢</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="chart-features">
        <div class="feature-item">
            <i class="fas fa-check-circle"></i>
            <span>åŸºäºçœŸå®ç®—æ³•åº“è°ƒç”¨çš„æ€§èƒ½æ•°æ®</span>
        </div>
        <div class="feature-item">
            <i class="fas fa-check-circle"></i>
            <span>16:10é»„é‡‘æ¯”ä¾‹ï¼Œé€‚é…ç°ä»£æ˜¾ç¤ºå™¨</span>
        </div>
        <div class="feature-item">
            <i class="fas fa-check-circle"></i>
            <span>ç»Ÿä¸€é…è‰²æ–¹æ¡ˆï¼Œä¾¿äºç®—æ³•è¯†åˆ«</span>
        </div>
        <div class="feature-item">
            <i class="fas fa-check-circle"></i>
            <span>ä¸“æ³¨PKEç®—æ³•å†…éƒ¨æ€§èƒ½å¯¹æ¯”</span>
        </div>
    </div>
</div>

<!-- åŠ¨æ€å›¾è¡¨å¯¹æ¯” -->
<div class="content-card">
    <h2 class="card-title"><i class="fas fa-chart-bar"></i> äº¤äº’å¼æ€§èƒ½å›¾è¡¨</h2>
    <p class="card-description">åŠ¨æ€å¯äº¤äº’çš„æ€§èƒ½å¯¹æ¯”å›¾è¡¨ï¼Œæ”¯æŒåˆ‡æ¢ä¸åŒç»´åº¦è¿›è¡Œåˆ†æã€‚</p>
    
    <div class="chart-selector">
        <button class="chart-tab active" onclick="switchChart('keyGeneration')">å¯†é’¥ç”Ÿæˆ</button>
        <button class="chart-tab" onclick="switchChart('encryption')">åŠ å¯†æ€§èƒ½</button>
        <button class="chart-tab" onclick="switchChart('decryption')">è§£å¯†æ€§èƒ½</button>
        <button class="chart-tab" onclick="switchChart('comprehensive')">ç»¼åˆå¯¹æ¯”</button>
    </div>
    
    <div class="chart-container">
        <canvas id="performanceChart" width="800" height="400"></canvas>
    </div>
    
    <div class="chart-description" id="chartDescription">
        æ­£åœ¨åŠ è½½æ€§èƒ½æ•°æ®...
    </div>
</div>

<!-- ç®—æ³•ç‰¹æ€§å¯¹æ¯” -->
<div class="content-card">
    <h2 class="card-title"><i class="fas fa-balance-scale"></i> ç®—æ³•ç‰¹æ€§å¯¹æ¯”</h2>
    <div class="algorithm-comparison">
        <div class="algo-card">
            <div class="algo-header">
                <i class="fas fa-shield-alt"></i>
                <h3>ECC (æ¤­åœ†æ›²çº¿)</h3>
            </div>
            <div class="algo-features">
                <div class="feature">âœ… é«˜å®‰å…¨æ€§</div>
                <div class="feature">âš¡ ä¸­ç­‰æ€§èƒ½</div>
                <div class="feature">ğŸ”‘ 256ä½å¯†é’¥</div>
                <div class="feature">ğŸŒ å¹¿æ³›åº”ç”¨</div>
            </div>
            <div class="algo-score" id="eccScore">è¯„åˆ†: -</div>
        </div>
        
        <div class="algo-card">
            <div class="algo-header">
                <i class="fas fa-calculator"></i>
                <h3>ElGamal (ç¦»æ•£å¯¹æ•°)</h3>
            </div>
            <div class="algo-features">
                <div class="feature">ğŸ“š ç»å…¸ç®—æ³•</div>
                <div class="feature">ğŸ”’ æ¦‚ç‡åŠ å¯†</div>
                <div class="feature">âš–ï¸ æ”¯æŒåŒæ€</div>
                <div class="feature">ğŸ“ æ¶ˆæ¯é•¿åº¦é™åˆ¶</div>
            </div>
            <div class="algo-score" id="elgamalScore">è¯„åˆ†: -</div>
        </div>
        
        <div class="algo-card">
            <div class="algo-header">
                <i class="fas fa-flag"></i>
                <h3>SM2 (å›½å¯†æ ‡å‡†)</h3>
            </div>
            <div class="algo-features">
                <div class="feature">ğŸ‡¨ğŸ‡³ å›½äº§ç®—æ³•</div>
                <div class="feature">âš¡ ä¼˜ç§€æ€§èƒ½</div>
                <div class="feature">âœ… åˆè§„æ ‡å‡†</div>
                <div class="feature">ğŸš€ å¿«é€Ÿå¯†é’¥ç”Ÿæˆ</div>
            </div>
            <div class="algo-score" id="sm2Score">è¯„åˆ†: -</div>
        </div>
    </div>
</div>

<!-- æ€§èƒ½å»ºè®® -->
<div class="content-card">
    <h2 class="card-title"><i class="fas fa-lightbulb"></i> ç®—æ³•é€‰æ‹©å»ºè®®</h2>
    <div class="recommendations">
        <div class="recommendation-item">
            <div class="rec-icon"><i class="fas fa-rocket"></i></div>
            <div class="rec-content">
                <h4>é«˜æ€§èƒ½åœºæ™¯</h4>
                <p>æ¨èä½¿ç”¨ <strong>SM2</strong> ç®—æ³•ï¼Œå¯†é’¥ç”Ÿæˆæå¿«ï¼ŒåŠ è§£å¯†æ€§èƒ½ä¼˜ç§€ï¼Œé€‚åˆé«˜é¢‘æ¬¡æ“ä½œã€‚</p>
            </div>
        </div>
        
        <div class="recommendation-item">
            <div class="rec-icon"><i class="fas fa-globe"></i></div>
            <div class="rec-content">
                <h4>å›½é™…å…¼å®¹</h4>
                <p>æ¨èä½¿ç”¨ <strong>ECC</strong> ç®—æ³•ï¼Œå›½é™…æ ‡å‡†ï¼Œåº”ç”¨å¹¿æ³›ï¼Œå®‰å…¨æ€§é«˜ï¼Œé€‚åˆè·¨å¹³å°åº”ç”¨ã€‚</p>
            </div>
        </div>
        
        <div class="recommendation-item">
            <div class="rec-icon"><i class="fas fa-graduation-cap"></i></div>
            <div class="rec-content">
                <h4>å­¦æœ¯ç ”ç©¶</h4>
                <p>æ¨èä½¿ç”¨ <strong>ElGamal</strong> ç®—æ³•ï¼Œç»å…¸çš„æ¦‚ç‡åŠ å¯†æ–¹æ¡ˆï¼Œç†è®ºä»·å€¼é«˜ï¼Œé€‚åˆæ•™å­¦å’Œç ”ç©¶ã€‚</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
let performanceData = null;
let currentChart = null;
let currentChartType = 'keyGeneration';

// é¡µé¢åŠ è½½æ—¶è·å–æ•°æ®
document.addEventListener('DOMContentLoaded', function() {
    loadPerformanceData();
});

// åŠ è½½æ€§èƒ½æ•°æ®
async function loadPerformanceData() {
    try {
        const response = await fetch('/api/pke/performance-data');
        const result = await response.json();
        
        if (result.status === 'success') {
            performanceData = result.data;
            updateOverviewStats();
            showChart('keyGeneration');
        } else {
            showError('åŠ è½½æ€§èƒ½æ•°æ®å¤±è´¥: ' + result.error);
        }
    } catch (error) {
        showError('ç½‘ç»œé”™è¯¯: ' + error.message);
    }
}

// æ›´æ–°æ¦‚è§ˆç»Ÿè®¡
function updateOverviewStats() {
    if (!performanceData) return;
    
    // è®¡ç®—å¹³å‡åŠ å¯†æ—¶é—´
    const encryptTimes = Object.values(performanceData.encryption_performance)
        .flatMap(data => data.times);
    const avgEncrypt = encryptTimes.reduce((a, b) => a + b, 0) / encryptTimes.length;
    
    // è®¡ç®—å¹³å‡è§£å¯†æ—¶é—´
    const decryptTimes = Object.values(performanceData.decryption_performance)
        .flatMap(data => data.times);
    const avgDecrypt = decryptTimes.reduce((a, b) => a + b, 0) / decryptTimes.length;
    
    // æ‰¾å‡ºæœ€ä¼˜ç®—æ³•
    const scores = performanceData.performance_scores.scores;
    const schemes = performanceData.performance_scores.schemes;
    const bestIndex = scores.indexOf(Math.min(...scores));
    const bestScheme = schemes[bestIndex];
    
    // æ›´æ–°æ˜¾ç¤º
    document.getElementById('avgEncryptTime').textContent = avgEncrypt.toFixed(2) + 'ms';
    document.getElementById('avgDecryptTime').textContent = avgDecrypt.toFixed(2) + 'ms';
    document.getElementById('bestPerformer').textContent = bestScheme;
    
    // æ›´æ–°ç®—æ³•è¯„åˆ†
    schemes.forEach((scheme, index) => {
        const scoreElement = document.getElementById(scheme.toLowerCase() + 'Score');
        if (scoreElement) {
            scoreElement.textContent = `è¯„åˆ†: ${scores[index].toFixed(3)}ms`;
        }
    });
}

// åˆ‡æ¢å›¾è¡¨
function switchChart(chartType) {
    // æ›´æ–°é€‰é¡¹å¡çŠ¶æ€
    document.querySelectorAll('.chart-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    event.target.classList.add('active');
    
    currentChartType = chartType;
    showChart(chartType);
}

// æ˜¾ç¤ºå›¾è¡¨
function showChart(chartType) {
    if (!performanceData) return;
    
    // é”€æ¯ç°æœ‰å›¾è¡¨
    if (currentChart) {
        currentChart.destroy();
    }
    
    const ctx = document.getElementById('performanceChart').getContext('2d');
    
    switch (chartType) {
        case 'keyGeneration':
            showKeyGenerationChart(ctx);
            break;
        case 'encryption':
            showEncryptionChart(ctx);
            break;
        case 'decryption':
            showDecryptionChart(ctx);
            break;
        case 'comprehensive':
            showComprehensiveChart(ctx);
            break;
    }
}

// å¯†é’¥ç”Ÿæˆæ€§èƒ½å›¾è¡¨
function showKeyGenerationChart(ctx) {
    const data = performanceData.key_generation;
    
    currentChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: data.schemes,
            datasets: [{
                label: 'å¯†é’¥ç”Ÿæˆæ—¶é—´ (ms)',
                data: data.times,
                backgroundColor: [
                    'rgba(102, 126, 234, 0.8)',
                    'rgba(162, 59, 114, 0.8)',
                    'rgba(241, 143, 1, 0.8)'
                ],
                borderColor: [
                    'rgba(102, 126, 234, 1)',
                    'rgba(162, 59, 114, 1)',
                    'rgba(241, 143, 1, 1)'
                ],
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'PKEç®—æ³•å¯†é’¥ç”Ÿæˆæ€§èƒ½å¯¹æ¯”',
                    font: { size: 16, weight: 'bold' }
                },
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'æ—¶é—´ (æ¯«ç§’)'
                    }
                }
            }
        }
    });
    
    updateChartDescription('å¯†é’¥ç”Ÿæˆæ€§èƒ½å¯¹æ¯”ï¼šSM2ç®—æ³•è¡¨ç°æœ€ä¼˜ï¼Œå¯†é’¥ç”Ÿæˆé€Ÿåº¦æå¿«ï¼›ECCç®—æ³•å±…ä¸­ï¼›ElGamalç®—æ³•ç›¸å¯¹è¾ƒæ…¢ä½†ä»åœ¨å¯æ¥å—èŒƒå›´å†…ã€‚');
}

// åŠ å¯†æ€§èƒ½å›¾è¡¨
function showEncryptionChart(ctx) {
    const data128 = performanceData.encryption_performance['128B'];
    const data1024 = performanceData.encryption_performance['1024B'];
    
    currentChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: data128.schemes,
            datasets: [{
                label: '128Bæ•°æ®åŠ å¯†æ—¶é—´ (ms)',
                data: data128.times,
                backgroundColor: 'rgba(102, 126, 234, 0.8)',
                borderColor: 'rgba(102, 126, 234, 1)',
                borderWidth: 2
            }, {
                label: '1024Bæ•°æ®åŠ å¯†æ—¶é—´ (ms)',
                data: data1024.times,
                backgroundColor: 'rgba(162, 59, 114, 0.8)',
                borderColor: 'rgba(162, 59, 114, 1)',
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'PKEç®—æ³•åŠ å¯†æ€§èƒ½å¯¹æ¯”',
                    font: { size: 16, weight: 'bold' }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'æ—¶é—´ (æ¯«ç§’)'
                    }
                }
            }
        }
    });
    
    updateChartDescription('åŠ å¯†æ€§èƒ½å¯¹æ¯”ï¼šæ˜¾ç¤ºäº†ä¸åŒæ•°æ®å¤§å°ä¸‹å„ç®—æ³•çš„åŠ å¯†è€—æ—¶ã€‚SM2å’ŒElGamalåœ¨å°æ•°æ®ä¸Šè¡¨ç°ä¼˜ç§€ï¼ŒECCåœ¨å¤§æ•°æ®åŠ å¯†ä¸Šæœ‰ä¸€å®šä¼˜åŠ¿ã€‚');
}

// è§£å¯†æ€§èƒ½å›¾è¡¨
function showDecryptionChart(ctx) {
    const data128 = performanceData.decryption_performance['128B'];
    const data1024 = performanceData.decryption_performance['1024B'];
    
    currentChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: data128.schemes,
            datasets: [{
                label: '128Bæ•°æ®è§£å¯†æ—¶é—´ (ms)',
                data: data128.times,
                borderColor: 'rgba(102, 126, 234, 1)',
                backgroundColor: 'rgba(102, 126, 234, 0.2)',
                tension: 0.4,
                fill: true
            }, {
                label: '1024Bæ•°æ®è§£å¯†æ—¶é—´ (ms)',
                data: data1024.times,
                borderColor: 'rgba(162, 59, 114, 1)',
                backgroundColor: 'rgba(162, 59, 114, 0.2)',
                tension: 0.4,
                fill: true
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'PKEç®—æ³•è§£å¯†æ€§èƒ½å¯¹æ¯”',
                    font: { size: 16, weight: 'bold' }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'æ—¶é—´ (æ¯«ç§’)'
                    }
                }
            }
        }
    });
    
    updateChartDescription('è§£å¯†æ€§èƒ½å¯¹æ¯”ï¼šSM2ç®—æ³•åœ¨è§£å¯†é€Ÿåº¦ä¸Šè¡¨ç°æœ€ä¼˜ï¼ŒElGamalæ¬¡ä¹‹ï¼ŒECCç›¸å¯¹è¾ƒæ…¢ä½†å·®è·ä¸å¤§ã€‚è§£å¯†æ€§èƒ½ä¸æ•°æ®å¤§å°å…³ç³»ä¸æ˜æ˜¾ã€‚');
}

// ç»¼åˆæ€§èƒ½é›·è¾¾å›¾
function showComprehensiveChart(ctx) {
    const scores = performanceData.performance_scores;
    
    currentChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['å¯†é’¥ç”Ÿæˆ', 'åŠ å¯†é€Ÿåº¦', 'è§£å¯†é€Ÿåº¦', 'å®‰å…¨æ€§', 'æ ‡å‡†åŒ–'],
            datasets: [{
                label: 'ECC',
                data: [5, 6, 5, 9, 9], // ç›¸å¯¹è¯„åˆ†
                borderColor: 'rgba(102, 126, 234, 1)',
                backgroundColor: 'rgba(102, 126, 234, 0.2)',
                pointBackgroundColor: 'rgba(102, 126, 234, 1)'
            }, {
                label: 'ElGamal',
                data: [7, 8, 7, 8, 6],
                borderColor: 'rgba(162, 59, 114, 1)',
                backgroundColor: 'rgba(162, 59, 114, 0.2)',
                pointBackgroundColor: 'rgba(162, 59, 114, 1)'
            }, {
                label: 'SM2',
                data: [10, 9, 10, 9, 8],
                borderColor: 'rgba(241, 143, 1, 1)',
                backgroundColor: 'rgba(241, 143, 1, 0.2)',
                pointBackgroundColor: 'rgba(241, 143, 1, 1)'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'PKEç®—æ³•ç»¼åˆæ€§èƒ½é›·è¾¾å›¾',
                    font: { size: 16, weight: 'bold' }
                }
            },
            scales: {
                r: {
                    beginAtZero: true,
                    max: 10,
                    ticks: {
                        stepSize: 2
                    }
                }
            }
        }
    });
    
    updateChartDescription('ç»¼åˆæ€§èƒ½é›·è¾¾å›¾ï¼šä»å¤šä¸ªç»´åº¦å¯¹æ¯”ä¸‰ç§ç®—æ³•ã€‚SM2åœ¨æ€§èƒ½æ–¹é¢è¡¨ç°æœ€ä¼˜ï¼ŒECCåœ¨å®‰å…¨æ€§å’Œæ ‡å‡†åŒ–æ–¹é¢é¢†å…ˆï¼ŒElGamalåœ¨ç†è®ºä»·å€¼æ–¹é¢æœ‰ä¼˜åŠ¿ã€‚');
}

// æ›´æ–°å›¾è¡¨æè¿°
function updateChartDescription(text) {
    document.getElementById('chartDescription').textContent = text;
}

// æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
function showError(message) {
    document.getElementById('chartDescription').innerHTML = 
        `<div style="color: #e74c3c; padding: 20px; text-align: center;">
            <i class="fas fa-exclamation-triangle"></i> ${message}
        </div>`;
}
</script>

<style>
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(20px);
    border-radius: 15px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
    border: 1px solid rgba(255, 255, 255, 0.18);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
}

.stat-icon {
    font-size: 2rem;
    color: #667eea;
}

.stat-value {
    font-size: 1.8rem;
    font-weight: bold;
    color: #333;
}

.stat-label {
    color: #666;
    font-size: 0.9rem;
}

.chart-selector {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.chart-tab {
    padding: 10px 20px;
    border: 2px solid #667eea;
    background: transparent;
    color: #667eea;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
}

.chart-tab:hover {
    background: rgba(102, 126, 234, 0.1);
}

.chart-tab.active {
    background: #667eea;
    color: white;
}

.chart-container {
    height: 400px;
    background: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 15px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.1);
}

.chart-description {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 10px;
    color: #555;
    line-height: 1.6;
    border-left: 4px solid #667eea;
}

.algorithm-comparison {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.algo-card {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
    border: 1px solid rgba(255, 255, 255, 0.18);
}

.algo-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
    color: #333;
}

.algo-header i {
    font-size: 1.5rem;
    color: #667eea;
}

.algo-features {
    margin-bottom: 15px;
}

.feature {
    padding: 5px 0;
    color: #555;
    font-size: 0.9rem;
}

.algo-score {
    font-weight: bold;
    color: #667eea;
    padding: 10px;
    background: rgba(102, 126, 234, 0.1);
    border-radius: 8px;
    text-align: center;
}

.recommendations {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.recommendation-item {
    display: flex;
    gap: 15px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 15px;
    border-left: 4px solid #667eea;
}

.rec-icon {
    font-size: 2rem;
    color: #667eea;
    flex-shrink: 0;
}

.rec-content h4 {
    color: #333;
    margin-bottom: 10px;
}

.rec-content p {
    color: #555;
    line-height: 1.6;
}

/* ä¸“é¡¹åˆ†æå›¾è¡¨æ ·å¼ */
.specialized-charts {
    display: grid;
    grid-template-columns: 1fr;
    gap: 30px;
    margin-bottom: 30px;
}

.chart-section {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.chart-section:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 40px rgba(31, 38, 135, 0.25);
}

.chart-header {
    margin-bottom: 20px;
    text-align: center;
}

.chart-header h3 {
    color: #333;
    margin-bottom: 8px;
    font-size: 1.4rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.chart-header p {
    color: #666;
    font-size: 0.95rem;
    margin: 0;
    line-height: 1.5;
}

.chart-image-container {
    position: relative;
    text-align: center;
    border-radius: 10px;
    overflow: hidden;
    background: #fafafa;
}

.analysis-chart {
    max-width: 100%;
    height: auto;
    border-radius: 10px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
}

.analysis-chart:hover {
    transform: scale(1.02);
}

.chart-placeholder {
    padding: 60px 20px;
    color: #999;
    font-size: 1.1rem;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
}

.chart-placeholder i {
    font-size: 3rem;
    margin-bottom: 15px;
    display: block;
    opacity: 0.6;
}

.chart-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    margin-top: 25px;
    padding: 20px;
    background: rgba(102, 126, 234, 0.05);
    border-radius: 10px;
    border-left: 4px solid #667eea;
}

.chart-features .feature-item {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #555;
    font-size: 0.9rem;
}

.chart-features .feature-item i {
    color: #667eea;
    font-size: 1rem;
}

.card-description {
    color: #666;
    font-size: 0.95rem;
    margin-bottom: 25px;
    line-height: 1.6;
    text-align: center;
    padding: 15px;
    background: rgba(102, 126, 234, 0.05);
    border-radius: 10px;
    border-left: 4px solid #667eea;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .analysis-chart {
        border-radius: 8px;
    }
    
    .chart-section {
        padding: 20px;
    }
    
    .chart-header h3 {
        font-size: 1.2rem;
    }
    
    .chart-features {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %} 